%% PolyTeXNancy V1.0
%% Document style for Polytech Nancy
%% C. Colombo - 11/2020
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{PolyTeXNancy}[2020/11/29 Polytech LaTeX package]

% Packages required -------------------------------------------------------
\RequirePackage[utf8]{inputenc}
\RequirePackage[T1]{fontenc}
\RequirePackage[french]{babel}
\RequirePackage{hyperref}
\RequirePackage{xcolor}
\RequirePackage{fancyhdr}
\RequirePackage{graphicx}
\RequirePackage{enumitem}
\usepackage{tikz}
\usetikzlibrary{calc}

% Margin definition  ------------------------------------------------------
\usepackage[headheight=130pt, footskip=60pt, bottom=4cm, left=2cm, right=2cm, top=4cm, a4paper]{geometry}% Ma√Ætrise les marges


%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Options %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Color definition --------------------------------------------------------
\definecolor{PolyDarkBlue}{RGB}{0,74,117}
%% Blue, Pink, Green, Orange, Purple, Red, Grey
\definecolor{PolyLightBlue}{RGB}{0,156,221}
\definecolor{PolyGreen}{RGB}{191,205,65}
\definecolor{PolyGrey}{RGB}{87,138,145}
\definecolor{PolyOrange}{RGB}{246,146,48}
\definecolor{PolyPink}{RGB}{208,0,111}
\definecolor{PolyPurple}{RGB}{160,83,159}
\definecolor{PolyRed}{RGB}{235,14,63}

\newcommand{\maincolor}{PolyLightBlue}

\DeclareOption{Blue}{\renewcommand{\maincolor}{PolyLightBlue}}
\DeclareOption{Green}{\renewcommand{\maincolor}{PolyGreen}}
\DeclareOption{Grey}{\renewcommand{\maincolor}{PolyGrey}}
\DeclareOption{Orange}{\renewcommand{\maincolor}{PolyOrange}}
\DeclareOption{Pink}{\renewcommand{\maincolor}{PolyPink}}
\DeclareOption{Purple}{\renewcommand{\maincolor}{PolyPurple}}
\DeclareOption{Red}{\renewcommand{\maincolor}{PolyRed}}

% Titles translation ------------------------------------------------------

\newcommand{\langue}{French}

\DeclareOption{French}{\renewcommand{\langue}{French}}
\DeclareOption{English}{\renewcommand{\langue}{English}}

% Font style --------------------------------------------------------------
\renewcommand{\familydefault}{\sfdefault}
\DeclareOption{classicfont}{\renewcommand{\familydefault}{\rmdefault}}

% End of options ----------------------------------------------------------
\ProcessOptions\relax
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Options %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Header and footer definition --------------------------------------------
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\pagestyle{fancy}
\fancyhf{}

\rhead{\includegraphics[height=1.6cm]{logo_polytech_nancy_bleu.pdf}}

% Savebox is used so tikz is not compiled each page
\newsavebox\topbox
\savebox\topbox{
    \begin{tikzpicture}[scale=0.4,every node/.style={transform shape}]
        \tikzstyle{squares} = [rectangle,minimum height=0.85cm,minimum width=0.85cm,]
        \coordinate (neanchor) at ($(0,0)-(1,1)$);
        \node[squares,fill=PolyDarkBlue] at ($(neanchor)+(-10, -3)$) {};
        \node[squares,fill=PolyDarkBlue] at ($(neanchor)+(-8, -1)$) {};
        \node[squares,fill=PolyDarkBlue] at ($(neanchor)+(-6, -2)$) {};
        \node[squares,fill=PolyDarkBlue] at ($(neanchor)+(-4, -1)$) {};
        \node[squares,fill=PolyDarkBlue] at ($(neanchor)+(-3, -2)$) {};
        \node[squares,fill=PolyDarkBlue] at ($(neanchor)+(-1, -3)$) {};
        \node[squares,fill=PolyDarkBlue] at ($(neanchor)+(-0, -2)$) {};
        \node[squares,fill=\maincolor] at ($(neanchor)+(-7, -0)$) {};
        \node[squares,fill=\maincolor] at ($(neanchor)+(-5, -1)$) {};
        \node[squares,fill=\maincolor] at ($(neanchor)+(-5, -2)$) {};
        \node[squares,fill=\maincolor] at ($(neanchor)+(-4, -4)$) {};
        \node[squares,fill=\maincolor] at ($(neanchor)+(-2, -3)$) {};
        \node[squares,fill=\maincolor] at ($(neanchor)+(-1, -2)$) {};
    \end{tikzpicture}
}
\lhead{\usebox{\topbox}}

\lfoot{\includegraphics[height=1.4cm]{logo_UL_INP.png}}

% Savebox is used so tikz is not compiled each page
\newsavebox\bottombox
\savebox\bottombox{
    \begin{tikzpicture}[scale=0.4,every node/.style={transform shape}]
        \tikzstyle{squares} = [rectangle,minimum height=0.85cm,minimum width=0.85cm,]
        \coordinate (neanchor) at (0,0);
        \node[squares,fill=PolyDarkBlue] at ($(neanchor)+(-6, -2)$) {};
        \node[squares,fill=PolyDarkBlue] at ($(neanchor)+(-3, -3)$) {};
        \node[squares,fill=PolyDarkBlue] at ($(neanchor)+(-1, -2)$) {};
        \node[squares,fill=\maincolor] at ($(neanchor)+(-2,0)$) {};
        \node[squares,fill=\maincolor] at ($(neanchor)+(-2,-2)$) {};
        \node[squares,fill=\maincolor] at ($(neanchor)+(-4,-2)$) {};
    \end{tikzpicture}
}

%Page number is offset to match tikz drawing
\rfoot{\raisebox{0.8cm}{\thepage} \hspace{-1.85cm} \usebox{\bottombox}}



% Titles color ------------------------------------------------------------
\usepackage{titlesec}

\titleformat{\section}
{\color{PolyDarkBlue}\normalfont\huge\bfseries}
{\color{PolyDarkBlue}\thesection}{1em}{}
\titlespacing*{\section}{0em}{0.5em}{0.5em}

\titleformat{\subsection}
{\color{PolyLightBlue}\normalfont\Large\bfseries}
{\color{PolyLightBlue}\thesubsection}{1em}{}
\titlespacing*{\subsection}{0em}{0.5em}{0.5em}

\titleformat{\subsubsection}
{\color{black}\normalfont\large\bfseries\itshape}
{\color{black}\thesubsubsection}{1em}{}
\titlespacing*{\subsubsection}{0em}{0.5em}{0.5em}


% Title page ----------------------------------------------------
\newcommand{\maketitlepage}{
    \begin{titlepage}
    	\centering
    	\includegraphics[height=2.5cm]{logo_polytech_nancy_bleu.pdf}\par\vspace{2cm}
    	{\scshape\Huge\bfseries \@title \par}
    	\vspace{3cm}
    	{\Large\itshape \@author \par}
    	\vspace{3cm}
    	{\Large \@date \par}
    	\vfill
    	\includegraphics[height=2.5cm]{logo_UL_INP.png}
    \end{titlepage}
}


\newcommand{\notitlepage}{
	\begin{center}
	    \color{PolyDarkBlue}
	    {\scshape\Large\bfseries \@title \par}
	    \vspace{0.5cm}
	    {\large\itshape \@author \par}
	    \vspace{0.5cm}
	    {\large \@date \par}
	    \vspace{1cm}
	\end{center}	
}




% List bullet style ----------------------------------------------
\newcommand*\squared[1]{\tikz{
            \node[rectangle,minimum height=0.1ex,minimum width=0.1ex, fill=#1] (sqr) {};}}
\setlist[itemize,1]{label=\squared{PolyDarkBlue}}
\setlist[itemize,2]{label=\squared{\maincolor}}
\setlist[itemize,3]{label=\textcolor{\maincolor}{--}}

\setlist[enumerate,1]{label=\textcolor{PolyDarkBlue}{\arabic*.}}
\setlist[enumerate,2]{label=\textcolor{PolyDarkBlue}{\alph*.}}
\setlist[enumerate,3]{label=\textcolor{PolyDarkBlue}{\roman*.}}

% Paragraph spacing ----------------------------------------------
\setlength{\parskip}{0.8em}
